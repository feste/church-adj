(define (last lst)
  (first (fold (lambda (a lst) (append (list a) lst)) '() lst)))

;100 bins
(define bins
  (mem
   (lambda (item)
     (case item
           (('watch) '((1    3    5    7    9   11   13   15   17   19   21   23   25   27   29
 31   33   35   37   39   41   43   45   47   49   51   53   55   57   59
 61   63   65   67   69   71   73   75   77   79   81   83   85   87   89
 91   93   95   97   99  101  103  105  107  109  111  113  115  117  119
 121  123  125  127  129  131  133  135  137  139  141  143  145  147  149
 151  153  155  157  159  161  163  165  167  169  171  173  175  177  179
 181  183  185  187  189  191  193  195  197  199  201  203  205  207  209
211  213  215  217  219  221  223  225  227  229  231  233  235  237  239
241  243  245  247  249  251  253  255  257  259  261  263  265  267  269
271  273  275  277  279  281  283  285  287  289  291  293  295  297  299
301  303  305  307  309  311  313  315  317  319  321  323  325  327  329
331  333  335  337  339  341  343  345  347  349  351  353  355  357  359
361  363  365  367  369  371  373  375  377  379  381  383  385  387  389
391  393  395  397  399  401  403  405  407  409  411  413  415  417  419
421  423  425  427  429  431  433  435  437  439  441  443  445  447  449
451  453  455  457  459  461  463  465  467  469  471  473  475  477  479
481  483  485  487  489  491  493  495  497  499  501  503  505  507  509
511  513  515  517  519  521  523  525  527  529  531  533  535  537  539
541  543  545  547  549  551  553  555  557  559  561  563  565  567  569
571  573  575  577  579  581  583  585  587  589  591  593  595  597  599
601  603  605  607  609  611  613  615  617  619  621  623  625  627  629
631  633  635  637  639  641  643  645  647  649  651  653  655  657  659
661  663  665  667  669  671  673  675  677  679  681  683  685  687  689
691  693  695  697  699  701  703  705  707  709  711  713  715  717  719
721  723  725  727  729  731  733  735  737  739  741  743  745  747  749
751  753  755  757  759  761  763  765  767  769  771  773  775  777  779
781  783  785  787  789  791  793  795  797  799  801  803  805  807  809
811  813  815  817  819  821  823  825  827  829  831  833  835  837  839
841  843  845  847  849  851  853  855  857  859  861  863  865  867  869
871  873  875  877  879  881  883  885  887  889  891  893  895  897  899
901  903  905  907  909  911  913  915  917  919  921  923  925  927  929
931  933  935  937  939  941  943  945  947  949  951  953  955  957  959
961  963  965  967  969  971  973  975  977  979  981  983  985  987  989
991  993  995  997  999 1001 1003 1005 1007 1009 1011 1013 1015 1017 1019
1021 1023 1025 1027 1029 1031 1033 1035 1037 1039 1041 1043 1045 1047 1049
1051 1053 1055 1057 1059 1061 1063 1065 1067 1069 1071 1073 1075 1077 1079
1081 1083 1085 1087 1089 1091 1093 1095 1097 1099 1101 1103 1105 1107 1109
1111 1113 1115 1117 1119 1121 1123 1125 1127 1129 1131 1133 1135 1137 1139
1141 1143 1145 1147 1149 1151 1153 1155 1157 1159 1161 1163 1165 1167 1169
1171 1173 1175 1177 1179 1181 1183 1185 1187 1189 1191 1193 1195 1197 1199
1201 1203 1205 1207 1209 1211 1213 1215 1217 1219 1221 1223 1225 1227 1229
1231 1233 1235 1237 1239 1241 1243 1245 1247 1249 1251 1253 1255 1257 1259
1261 1263 1265 1267 1269 1271 1273 1275 1277 1279 1281 1283 1285 1287 1289
1291 1293 1295 1297 1299 1301 1303 1305 1307 1309 1311 1313 1315 1317 1319
1321 1323 1325 1327 1329 1331 1333 1335 1337 1339 1341 1343 1345 1347 1349
1351 1353 1355 1357 1359 1361 1363 1365 1367 1369 1371 1373 1375 1377 1379
1381 1383 1385 1387 1389 1391 1393 1395 1397 1399 1401 1403 1405 1407 1409
1411 1413 1415 1417 1419 1421 1423 1425 1427 1429 1431 1433 1435 1437 1439
1441 1443 1445 1447 1449 1451 1453 1455 1457 1459 1461 1463 1465 1467 1469
1471 1473 1475 1477 1479 1481 1483 1485 1487 1489 1491 1493 1495 1497 1499
1501 1503 1505 1507 1509 1511 1513 1515 1517 1519 1521 1523 1525 1527 1529
1531 1533 1535 1537 1539 1541 1543 1545 1547 1549 1551 1553 1555 1557 1559
1561 1563 1565 1567 1569 1571 1573 1575 1577 1579 1581 1583 1585 1587 1589
1591 1593 1595 1597 1599 1601 1603 1605 1607 1609 1611 1613 1615 1617 1619
1621 1623 1625 1627 1629 1631 1633 1635 1637 1639 1641 1643 1645 1647 1649
1651 1653 1655 1657 1659 1661 1663 1665 1667 1669 1671 1673 1675 1677 1679
1681 1683 1685 1687 1689 1691 1693 1695 1697 1699 1701 1703 1705 1707 1709
1711 1713 1715 1717 1719 1721 1723 1725 1727 1729 1731 1733 1735 1737 1739
1741 1743 1745 1747 1749 1751 1753 1755 1757 1759 1761 1763 1765 1767 1769
1771 1773 1775 1777 1779 1781 1783 1785 1787 1789 1791 1793 1795 1797 1799
1801 1803 1805 1807 1809 1811 1813 1815 1817 1819 1821 1823 1825 1827 1829
1831 1833 1835 1837 1839 1841 1843 1845 1847 1849 1851 1853 1855 1857 1859
1861 1863 1865 1867 1869 1871 1873 1875 1877 1879 1881 1883 1885 1887 1889
1891 1893 1895 1897 1899 1901 1903 1905 1907 1909 1911 1913 1915 1917 1919
1921 1923 1925 1927 1929 1931 1933 1935 1937 1939 1941 1943 1945 1947)
                       (0.045394619 0.045394619 0.045394619 0.045394619 0.045394619 0.045394619
  0.045394619 0.045394619 0.045394619 0.045394619 0.045394619 0.045394619
 0.045394619 0.045394619 0.045394619 0.045394619 0.045394619 0.045394619
 0.045394619 0.045394619 0.045394619 0.045394619 0.045394619 0.045394619
 0.045394619 0.057381326 0.057381326 0.057381326 0.057381326 0.057381326
 0.057381326 0.057381326 0.057381326 0.057381326 0.057381326 0.057381326
 0.057381326 0.057381326 0.057381326 0.057381326 0.057381326 0.057381326
 0.057381326 0.057381326 0.057381326 0.057381326 0.057381326 0.057381326
 0.057381326 0.057381326 0.059904563 0.059904563 0.059904563 0.059904563
 0.059904563 0.059904563 0.059904563 0.059904563 0.059904563 0.059904563
 0.059904563 0.059904563 0.059904563 0.059904563 0.059904563 0.059904563
 0.059904563 0.059904563 0.059904563 0.059904563 0.059904563 0.059904563
 0.059904563 0.059904563 0.059904563 0.064643033 0.064643033 0.064643033
 0.064643033 0.064643033 0.064643033 0.064643033 0.064643033 0.064643033
 0.064643033 0.064643033 0.064643033 0.064643033 0.064643033 0.064643033
 0.064643033 0.064643033 0.064643033 0.064643033 0.064643033 0.064643033
 0.064643033 0.064643033 0.064643033 0.064643033 0.063082378 0.063082378
0.063082378 0.063082378 0.063082378 0.063082378 0.063082378 0.063082378
0.063082378 0.063082378 0.063082378 0.063082378 0.063082378 0.063082378
0.063082378 0.063082378 0.063082378 0.063082378 0.063082378 0.063082378
0.063082378 0.063082378 0.063082378 0.063082378 0.063082378 0.061099834
0.061099834 0.061099834 0.061099834 0.061099834 0.061099834 0.061099834
0.061099834 0.061099834 0.061099834 0.061099834 0.061099834 0.061099834
0.061099834 0.061099834 0.061099834 0.061099834 0.061099834 0.061099834
0.061099834 0.061099834 0.061099834 0.061099834 0.061099834 0.061099834
0.055827315 0.055827315 0.055827315 0.055827315 0.055827315 0.055827315
0.055827315 0.055827315 0.055827315 0.055827315 0.055827315 0.055827315
0.055827315 0.055827315 0.055827315 0.055827315 0.055827315 0.055827315
0.055827315 0.055827315 0.055827315 0.055827315 0.055827315 0.055827315
0.055827315 0.050233678 0.050233678 0.050233678 0.050233678 0.050233678
0.050233678 0.050233678 0.050233678 0.050233678 0.050233678 0.050233678
0.050233678 0.050233678 0.050233678 0.050233678 0.050233678 0.050233678
0.050233678 0.050233678 0.050233678 0.050233678 0.050233678 0.050233678
0.050233678 0.050233678 0.045204002 0.045204002 0.045204002 0.045204002
0.045204002 0.045204002 0.045204002 0.045204002 0.045204002 0.045204002
0.045204002 0.045204002 0.045204002 0.045204002 0.045204002 0.045204002
0.045204002 0.045204002 0.045204002 0.045204002 0.045204002 0.045204002
0.045204002 0.045204002 0.045204002 0.044185680 0.044185680 0.044185680
0.044185680 0.044185680 0.044185680 0.044185680 0.044185680 0.044185680
0.044185680 0.044185680 0.044185680 0.044185680 0.044185680 0.044185680
0.044185680 0.044185680 0.044185680 0.044185680 0.044185680 0.044185680
0.044185680 0.044185680 0.044185680 0.044185680 0.035528392 0.035528392
0.035528392 0.035528392 0.035528392 0.035528392 0.035528392 0.035528392
0.035528392 0.035528392 0.035528392 0.035528392 0.035528392 0.035528392
0.035528392 0.035528392 0.035528392 0.035528392 0.035528392 0.035528392
0.035528392 0.035528392 0.035528392 0.035528392 0.035528392 0.031902004
0.031902004 0.031902004 0.031902004 0.031902004 0.031902004 0.031902004
0.031902004 0.031902004 0.031902004 0.031902004 0.031902004 0.031902004
0.031902004 0.031902004 0.031902004 0.031902004 0.031902004 0.031902004
0.031902004 0.031902004 0.031902004 0.031902004 0.031902004 0.031902004
0.029280822 0.029280822 0.029280822 0.029280822 0.029280822 0.029280822
0.029280822 0.029280822 0.029280822 0.029280822 0.029280822 0.029280822
0.029280822 0.029280822 0.029280822 0.029280822 0.029280822 0.029280822
0.029280822 0.029280822 0.029280822 0.029280822 0.029280822 0.029280822
0.029280822 0.027107983 0.027107983 0.027107983 0.027107983 0.027107983
0.027107983 0.027107983 0.027107983 0.027107983 0.027107983 0.027107983
0.027107983 0.027107983 0.027107983 0.027107983 0.027107983 0.027107983
0.027107983 0.027107983 0.027107983 0.027107983 0.027107983 0.027107983
0.027107983 0.027107983 0.023656186 0.023656186 0.023656186 0.023656186
0.023656186 0.023656186 0.023656186 0.023656186 0.023656186 0.023656186
0.023656186 0.023656186 0.023656186 0.023656186 0.023656186 0.023656186
0.023656186 0.023656186 0.023656186 0.023656186 0.023656186 0.023656186
0.023656186 0.023656186 0.023656186 0.022114303 0.022114303 0.022114303
0.022114303 0.022114303 0.022114303 0.022114303 0.022114303 0.022114303
0.022114303 0.022114303 0.022114303 0.022114303 0.022114303 0.022114303
0.022114303 0.022114303 0.022114303 0.022114303 0.022114303 0.022114303
0.022114303 0.022114303 0.022114303 0.022114303 0.019388853 0.019388853
0.019388853 0.019388853 0.019388853 0.019388853 0.019388853 0.019388853
0.019388853 0.019388853 0.019388853 0.019388853 0.019388853 0.019388853
0.019388853 0.019388853 0.019388853 0.019388853 0.019388853 0.019388853
0.019388853 0.019388853 0.019388853 0.019388853 0.019388853 0.017223640
0.017223640 0.017223640 0.017223640 0.017223640 0.017223640 0.017223640
0.017223640 0.017223640 0.017223640 0.017223640 0.017223640 0.017223640
0.017223640 0.017223640 0.017223640 0.017223640 0.017223640 0.017223640
0.017223640 0.017223640 0.017223640 0.017223640 0.017223640 0.017223640
0.016756868 0.016756868 0.016756868 0.016756868 0.016756868 0.016756868
0.016756868 0.016756868 0.016756868 0.016756868 0.016756868 0.016756868
0.016756868 0.016756868 0.016756868 0.016756868 0.016756868 0.016756868
0.016756868 0.016756868 0.016756868 0.016756868 0.016756868 0.016756868
0.016756868 0.015991584 0.015991584 0.015991584 0.015991584 0.015991584
0.015991584 0.015991584 0.015991584 0.015991584 0.015991584 0.015991584
0.015991584 0.015991584 0.015991584 0.015991584 0.015991584 0.015991584
0.015991584 0.015991584 0.015991584 0.015991584 0.015991584 0.015991584
0.015991584 0.015991584 0.016221740 0.016221740 0.016221740 0.016221740
0.016221740 0.016221740 0.016221740 0.016221740 0.016221740 0.016221740
0.016221740 0.016221740 0.016221740 0.016221740 0.016221740 0.016221740
0.016221740 0.016221740 0.016221740 0.016221740 0.016221740 0.016221740
0.016221740 0.016221740 0.016221740 0.013899249 0.013899249 0.013899249
0.013899249 0.013899249 0.013899249 0.013899249 0.013899249 0.013899249
0.013899249 0.013899249 0.013899249 0.013899249 0.013899249 0.013899249
0.013899249 0.013899249 0.013899249 0.013899249 0.013899249 0.013899249
0.013899249 0.013899249 0.013899249 0.013899249 0.012743487 0.012743487
0.012743487 0.012743487 0.012743487 0.012743487 0.012743487 0.012743487
0.012743487 0.012743487 0.012743487 0.012743487 0.012743487 0.012743487
0.012743487 0.012743487 0.012743487 0.012743487 0.012743487 0.012743487
0.012743487 0.012743487 0.012743487 0.012743487 0.012743487 0.011967313
0.011967313 0.011967313 0.011967313 0.011967313 0.011967313 0.011967313
0.011967313 0.011967313 0.011967313 0.011967313 0.011967313 0.011967313
0.011967313 0.011967313 0.011967313 0.011967313 0.011967313 0.011967313
0.011967313 0.011967313 0.011967313 0.011967313 0.011967313 0.011967313
0.010809493 0.010809493 0.010809493 0.010809493 0.010809493 0.010809493
0.010809493 0.010809493 0.010809493 0.010809493 0.010809493 0.010809493
0.010809493 0.010809493 0.010809493 0.010809493 0.010809493 0.010809493
0.010809493 0.010809493 0.010809493 0.010809493 0.010809493 0.010809493
0.010809493 0.009696578 0.009696578 0.009696578 0.009696578 0.009696578
0.009696578 0.009696578 0.009696578 0.009696578 0.009696578 0.009696578
0.009696578 0.009696578 0.009696578 0.009696578 0.009696578 0.009696578
0.009696578 0.009696578 0.009696578 0.009696578 0.009696578 0.009696578
0.009696578 0.009696578 0.008921870 0.008921870 0.008921870 0.008921870
0.008921870 0.008921870 0.008921870 0.008921870 0.008921870 0.008921870
0.008921870 0.008921870 0.008921870 0.008921870 0.008921870 0.008921870
0.008921870 0.008921870 0.008921870 0.008921870 0.008921870 0.008921870
0.008921870 0.008921870 0.008921870 0.008708051 0.008708051 0.008708051
0.008708051 0.008708051 0.008708051 0.008708051 0.008708051 0.008708051
0.008708051 0.008708051 0.008708051 0.008708051 0.008708051 0.008708051
0.008708051 0.008708051 0.008708051 0.008708051 0.008708051 0.008708051
0.008708051 0.008708051 0.008708051 0.008708051 0.008782277 0.008782277
0.008782277 0.008782277 0.008782277 0.008782277 0.008782277 0.008782277
0.008782277 0.008782277 0.008782277 0.008782277 0.008782277 0.008782277
0.008782277 0.008782277 0.008782277 0.008782277 0.008782277 0.008782277
0.008782277 0.008782277 0.008782277 0.008782277 0.008782277 0.007915141
0.007915141 0.007915141 0.007915141 0.007915141 0.007915141 0.007915141
0.007915141 0.007915141 0.007915141 0.007915141 0.007915141 0.007915141
0.007915141 0.007915141 0.007915141 0.007915141 0.007915141 0.007915141
0.007915141 0.007915141 0.007915141 0.007915141 0.007915141 0.007915141
0.006006488 0.006006488 0.006006488 0.006006488 0.006006488 0.006006488
0.006006488 0.006006488 0.006006488 0.006006488 0.006006488 0.006006488
0.006006488 0.006006488 0.006006488 0.006006488 0.006006488 0.006006488
0.006006488 0.006006488 0.006006488 0.006006488 0.006006488 0.006006488
0.006006488 0.004656862 0.004656862 0.004656862 0.004656862 0.004656862
0.004656862 0.004656862 0.004656862 0.004656862 0.004656862 0.004656862
0.004656862 0.004656862 0.004656862 0.004656862 0.004656862 0.004656862
0.004656862 0.004656862 0.004656862 0.004656862 0.004656862 0.004656862
0.004656862 0.004656862 0.005005289 0.005005289 0.005005289 0.005005289
0.005005289 0.005005289 0.005005289 0.005005289 0.005005289 0.005005289
0.005005289 0.005005289 0.005005289 0.005005289 0.005005289 0.005005289
0.005005289 0.005005289 0.005005289 0.005005289 0.005005289 0.005005289
0.005005289 0.005005289 0.005005289 0.004463550 0.004463550 0.004463550
0.004463550 0.004463550 0.004463550 0.004463550 0.004463550 0.004463550
0.004463550 0.004463550 0.004463550 0.004463550 0.004463550 0.004463550
0.004463550 0.004463550 0.004463550 0.004463550 0.004463550 0.004463550
0.004463550 0.004463550 0.004463550 0.004463550 0.004433551 0.004433551
0.004433551 0.004433551 0.004433551 0.004433551 0.004433551 0.004433551
0.004433551 0.004433551 0.004433551 0.004433551 0.004433551 0.004433551
0.004433551 0.004433551 0.004433551 0.004433551 0.004433551 0.004433551
0.004433551 0.004433551 0.004433551 0.004433551 0.004433551 0.004001521
0.004001521 0.004001521 0.004001521 0.004001521 0.004001521 0.004001521
0.004001521 0.004001521 0.004001521 0.004001521 0.004001521 0.004001521
0.004001521 0.004001521 0.004001521 0.004001521 0.004001521 0.004001521
0.004001521 0.004001521 0.004001521 0.004001521 0.004001521 0.004001521
0.004104724 0.004104724 0.004104724 0.004104724 0.004104724 0.004104724
0.004104724 0.004104724 0.004104724 0.004104724 0.004104724 0.004104724
0.004104724 0.004104724 0.004104724 0.004104724 0.004104724 0.004104724
0.004104724 0.004104724 0.004104724 0.004104724 0.004104724 0.004104724
0.004104724 0.003705019 0.003705019 0.003705019 0.003705019 0.003705019
0.003705019 0.003705019 0.003705019 0.003705019 0.003705019 0.003705019
0.003705019 0.003705019 0.003705019 0.003705019 0.003705019 0.003705019
0.003705019 0.003705019 0.003705019 0.003705019 0.003705019 0.003705019
0.003705019 0.003705019 0.004197382 0.004197382 0.004197382 0.004197382
0.004197382 0.004197382 0.004197382 0.004197382 0.004197382 0.004197382
0.004197382 0.004197382 0.004197382 0.004197382 0.004197382 0.004197382
0.004197382 0.004197382 0.004197382 0.004197382 0.004197382 0.004197382
0.004197382 0.004197382)))
           (('coffee-maker) '((2   6  10  14  18  22  26  30  34  38  42  46  50  54  58  62  66  70  74
78  82  86  90  94  98 102 106 110 114 118 122 126 130 134 138 142 146 150
154 158 162 166 170 174 178 182 186 190 194 198 202 206 210 214 218 222 226
230 234 238 242 246 250 254 258 262 266 270)
                              (0.001728231 0.001822157 0.001903340 0.005162553 0.006556096 0.007109373
 0.008484923 0.010052023 0.011757732 0.013493140 0.014206264 0.018856983
0.023338585 0.028013125 0.033330435 0.036741222 0.040219138 0.043120213
0.045874066 0.046046705 0.045639621 0.044613542 0.042512028 0.038373922
0.034287974 0.028790576 0.024018477 0.018568475 0.016106424 0.015328733
0.014812232 0.014918515 0.013205651 0.012835130 0.010400511 0.010913245
0.010059814 0.009607974 0.009738472 0.010092042 0.008760135 0.009021755
0.008894323 0.008881729 0.008862341 0.008621310 0.008107702 0.008229807
0.007981523 0.007930803 0.007198454 0.006773022 0.006737068 0.006455510
0.005672109 0.005082119 0.005279927 0.005101857 0.005206544 0.004736476
0.004364983 0.004606961 0.004960074 0.005146150 0.004163549 0.004311836
0.003213670 0.003058598)))
           (('sweater) '((1.5   4.5   7.5  10.5  13.5  16.5  19.5  22.5  25.5  28.5  31.5  34.5
37.5  40.5  43.5  46.5  49.5  52.5  55.5  58.5  61.5  64.5  67.5  70.5
73.5  76.5  79.5  82.5  85.5  88.5  91.5  94.5  97.5 100.5 103.5 106.5
109.5 112.5 115.5 118.5 121.5 124.5 127.5 130.5 133.5 136.5 139.5 142.5
145.5 148.5 151.5 154.5 157.5 160.5 163.5 166.5 169.5 172.5 175.5 178.5
181.5 184.5 187.5 190.5 193.5 196.5 199.5 202.5 205.5 208.5 211.5 214.5
217.5 220.5 223.5 226.5 229.5 232.5 235.5 238.5)
                         (0.002210627 0.004072956 0.004021475 0.005214907 0.007215928 0.009587922
 0.014194857 0.018235251 0.019977757 0.021632221 0.021910111 0.022941228
0.023824290 0.023779437 0.023831122 0.022196595 0.021919164 0.021807381
0.022321878 0.022744623 0.025013486 0.023687822 0.023130989 0.023809088
0.023201559 0.024006710 0.023354456 0.022151283 0.022263999 0.021755623
0.022047844 0.022020135 0.021922011 0.022581305 0.023250209 0.023158139
0.022609335 0.021514437 0.020619275 0.020056132 0.019250631 0.017861476
0.016758905 0.014481167 0.012428447 0.011271084 0.008310830 0.007937118
0.007362313 0.005806089 0.005488104 0.005275931 0.004914499 0.005214256
0.005198599 0.004827809 0.005106812 0.004557574 0.004721559 0.004989940
0.003889654 0.003293360 0.002820312 0.002812720 0.002564140 0.003008737
0.002364985 0.002411417 0.002367556 0.002413543 0.001488557 0.001546829
0.001424871 0.001726305 0.001452035 0.001495848 0.001410889 0.001205326
0.001322567 0.001423639)))
           (('laptop) '((25   75  125  175  225  275  325  375  425  475  525  575  625  675  725
775  825  875  925  975 1025 1075 1125 1175 1225 1275 1325 1375 1425 1475
1525 1575 1625 1675 1725 1775 1825 1875 1925 1975 2025 2075 2125 2175 2225
2275 2325 2375 2425 2475)
                        (0.0009310064 0.0011884102 0.0021721398 0.0050867297 0.0049808083
 0.0065739712 0.0089626149 0.0105528899 0.0150651007 0.0236159508
0.0268201818 0.0296707143 0.0334073527 0.0349452423 0.0364963072
0.0365472443 0.0390717088 0.0395122583 0.0379233390 0.0382949282
0.0371772401 0.0347828666 0.0324454504 0.0305074996 0.0293972413
0.0279435603 0.0271349390 0.0254704374 0.0250848643 0.0231664962
0.0223018936 0.0223633065 0.0206730502 0.0195103336 0.0192352191
0.0191287642 0.0176133964 0.0164248026 0.0162515500 0.0141631769
0.0120586581 0.0103775394 0.0086176142 0.0087565548 0.0088608048
0.0087191076 0.0082663310 0.0078526157 0.0072507336 0.0066450537)))
           (('headphones) '((3   9  15  21  27  33  39  45  51  57  63  69  75  81  87  93  99 105 111
117 123 129 135 141 147 153 159 165 171 177 183 189 195 201 207 213 219 225
231 237 243 249 255 261 267 273 279 285 291 297 303 309 315 321 327)
                            (0.008641546 0.012594913 0.019743065 0.029857325 0.038836861 0.040502359
 0.040347567 0.037354244 0.036172990 0.034468127 0.035123044 0.035823774
0.034241387 0.029861385 0.029694603 0.031499949 0.031312390 0.031560387
0.032149555 0.032577552 0.028120668 0.025413944 0.022245386 0.020750662
0.017714292 0.015672652 0.014333027 0.013809254 0.013553093 0.013376262
0.011728364 0.011269501 0.011354401 0.009978240 0.009996372 0.010179550
0.009616038 0.009459217 0.008908933 0.009243733 0.009727741 0.010831611
0.010274619 0.009036703 0.007976991 0.006632259 0.006460408 0.006192346
0.005758025 0.005264248 0.003429586 0.002838308 0.002465200 0.001967069
0.002058275)))))))

;\(([0-9.]+ *)+\)
;\n *\[[0-9]+\] *

(define (prior item) (apply multinomial (bins item)))
(define (theta-prior item) (uniform-draw (first (bins item))))

(define (utterance-prior) (multinomial '(expensive no-utt) '(0.3678794 1)))

(define pragmatic-listener
  (mem (lambda (utterance item)
         ;query price and theta given speaker would have said that
         (mh-query 30000 5
                   (define price (apply multinomial (bins item)))
                   (define theta (theta-prior item))
                   (list price theta)
                   (eq? (apply multinomial (speaker price theta item)) utterance)))))

(define speaker
  (mem (lambda (price theta item)
         ;query utterance given literal listener would guess price given theta
         (enumeration-query
          (define u (utterance-prior))
          u
          (eq? (apply multinomial (literal-listener u theta item)) price)))))

(define literal-listener
  (mem (lambda (u theta item)
         (define bin (bins item))
         (define (post-utterance)
           (define bin-pairs (map list
                                  (first bin)
                                  (second bin)))
           (define filtered-bin-pairs (fold
                                       (lambda (a lst) (if (>= (first a) theta)
                                                           (pair a lst)
                                                           lst))
                                       '()
                                       bin-pairs))
           (list (map first filtered-bin-pairs) (map second filtered-bin-pairs)))
         (if (eq? u 'expensive)
             (post-utterance)
             bin))))


(define sorites-model
  (mem
   (lambda (item)
     ;human data for comparison
     (define people (case item
                          (('watch) '(8.308824 8.454545 7.652778 6.826667 6.255319 5.750000))
                          (('laptop) '(8.394366 8.337838 7.179104 5.214286 4.550000 3.536585))
                          (('coffee-maker) '(8.554054 7.746269 6.613333 6.171875 5.150000 4.414634))
                          (('headphones) '(8.460526 7.985075 5.936508 5.337500 4.352941 4.045455))
                          (('sweater) '(8.655738 7.973684 7.027397 6.377049 5.179487 4.000000))))
     
     
     ;human standard deviations from experiment
     (define epsilons (map (lambda (e) (* e (case item
                                                  (('watch) 15.28736)
                                                  (('laptop) 254.2707)
                                                  (('coffee-maker) 22.31799)
                                                  (('headphones) 31.54902)
                                                  (('sweater) 15.28736))))
                           '(0.01 0.10 0.50 1.00 2.00 3.00)))
     
     ;results of model-
     (define samples (pragmatic-listener 'expensive item))
     (define prices (map first samples))
     (define thetas (map second samples))
     (display item)
     (map display prices)
     
     ;inductive premise
     (define (inductive e)
       (define lst (map (lambda (p t) (if (>= (- p e) t) 1 0)) prices thetas))
       ;get mean value of inductive premise
       (/ (apply + lst) (length lst)))
     
     (define model-judgements (map inductive epsilons))
     ;comparison: people to model
     (define people-vs-model (map pair
                                  people
                                  (map inductive epsilons)))
     (list people-vs-model
           model-judgements
           prices
           thetas))))

(define items '(watch
                laptop
                coffee-maker
                headphones
                sweater))

(define ppl-vs-mod (fold
                    append
                    '()
                    (map (lambda (item) (first (sorites-model item))) items)))

(display "final")
(list
 'watch
 (second (sorites-model 'watch))
 (mean (third (sorites-model 'watch)))
 (mean (fourth (sorites-model 'watch)))
 'laptop
 (second (sorites-model 'laptop))
 (mean (third (sorites-model 'laptop)))
 (mean (fourth (sorites-model 'laptop)))
 'coffee-maker
 (second (sorites-model 'coffee-maker))
 (mean (third (sorites-model 'coffee-maker)))
 (mean (fourth (sorites-model 'coffee-maker)))
 'headphones
 (second (sorites-model 'headphones))
 (mean (third (sorites-model 'headphones)))
 (mean (fourth (sorites-model 'headphones)))
 'sweater
 (second (sorites-model 'sweater))
 (mean (third (sorites-model 'sweater)))
 (mean (fourth (sorites-model 'sweater))))